\documentclass[usepdftitle=false]{beamer}

\usetheme{focus} % see https://github.com/elauksap/focus-beamertheme
% Add option [numbering=none] to disable the footer progress bar
% Add option [numbering=fullbar] to show the footer progress bar as always full with a slide count

\usepackage{booktabs} % Required for better table rules
\usepackage{bm,times}

\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing,calc}

\usepackage{hyperref}
\hypersetup{
    pdftitle={Evolution of ice sheet geometry using Stokes dynamics}
}

\newcommand{\tikzmark}[1]{\tikz[overlay,remember picture] \node (#1) {};}

\newcommand{\eps}{\epsilon}
\newcommand{\RR}{\mathbb{R}}

\newcommand{\grad}{\nabla}
\newcommand{\Div}{\nabla\cdot}
\newcommand{\trace}{\operatorname{tr}}

\newcommand{\hbn}{\hat{\mathbf{n}}}

\newcommand{\bb}{\mathbf{b}}
\newcommand{\be}{\mathbf{e}}
\newcommand{\bbf}{\mathbf{f}}
\newcommand{\bg}{\mathbf{g}}
\newcommand{\bn}{\mathbf{n}}
\newcommand{\br}{\mathbf{r}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bx}{\mathbf{x}}

\newcommand{\bF}{\mathbf{F}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bX}{\mathbf{X}}

\newcommand{\bxi}{\bm{\xi}}

\newcommand{\bzero}{\bm{0}}

\newcommand{\rhoi}{\rho_{\text{i}}}

\newcommand{\ip}[2]{\left(#1,#2\right)}

\newcommand{\mR}{R^{\bm{\oplus}}}
\newcommand{\iR}{R^{\bullet}}

\newcommand{\pp}{{\text{p}}}
\newcommand{\qq}{{\text{q}}}
\newcommand{\rr}{{\text{r}}}

\newcommand{\bus}{\bu|_s}


\title{Evolution of \\ ice sheet geometry \\ using Stokes dynamics}

%\subtitle{Subtitle}

\author{Ed Bueler}

\titlegraphic{\includegraphics[width=0.7\textwidth]{figs/titleextruded.png} \\ \vspace{-3mm} \includegraphics[width=0.15\textwidth]{figs/uafbw.png}}

%\institute{University of Alaska Fairbanks}

\date{\phantom{foo} \bigskip \bigskip \bigskip \\ SIAM GS21 \\ with assistance from Lawrence Mitchell}


\begin{document}

\begin{frame}
	\maketitle
\end{frame}


\begin{frame}{the ice geometry problem (IGP)}

\vspace{-2mm}
\begin{center}
\includegraphics[width=0.7\textwidth]{figs/stokesdomain.png}
\end{center}

\vspace{-1mm}
\begin{itemize}
\item glacier geometry which evolves according to climate
\item take simplest such problem (grounded, nonsliding, isothermal)
\item for simplicity, assume time-independent data on fixed $\Omega \subset \RR^2$:
    \begin{itemize}
    \item (net) climatic mass balance $a$ \hfill $\gets$ \emph{$a>0$ for accumulation}
    \item bed elevation $b$
    \end{itemize}
\item \emph{to compute}: surface elevation $s$ on $\Omega$ and icy domain $\Lambda_s \subset \RR^3$
\end{itemize}
\end{frame}


\begin{frame}{surface kinematical equation}

\begin{itemize}
\item glaciers flow
\item $\therefore$ must solve an equation for the surface elevation
\item the surface kinematical equation (SKE) holds \emph{on} the ice
\begin{align*}
\frac{\partial s}{\partial t} - \bu|_s \cdot \bn_s - a &= 0 & &\text{\emph{evolving}} \\
-\bu|_s \cdot \bn_s - a &= 0 & &\text{\emph{steady state}}
\end{align*}

    \begin{itemize}
    \item $\bn_s = \left<-s_x,-s_y,1\right>$  \, is an upward normal to the ice surface
    \item where \emph{not} on the ice: $a\le 0$
    \end{itemize}
\end{itemize}

\bigskip
\begin{columns}
    \column{0.55\textwidth}
        \begin{itemize}
        \item assumed for this talk:
            \begin{itemize}
            \item $s$ well-defined (no overhangs)
            \item $s=b$ where ice is not present
            \item $s$ is defined on all of $\Omega$
            \end{itemize}
        \end{itemize}
    \column{0.45\textwidth}
        \includegraphics[width=1.0\textwidth]{figs/simpledomain.png}
\end{columns}
\end{frame}


\begin{frame}{steady IGP strong form}

\begin{itemize}
\item the steady IGP free-boundary problem, for $s(x,y)$ on $\Omega$, is a \alert{nonlinear complementarity problem (NCP) for $s$ which is coupled to a non-Newtonian Stokes problem for $\bu,p$:}

\vspace{-5mm}

\begin{align*}
s - b &\ge 0 && \text{on $\Omega$} & \tikzmark{ncptop} \\
- \bu|_s \cdot \bn_s - a &\ge 0 && \text{''} \\
(s - b) (- \bu|_s \cdot \bn_s - a) &= 0 && \text{''} & \tikzmark{ncpbot} \\
- \nabla \cdot \left(2 \nu_\eps\, D\bu\right) + \nabla p - \rhoi \mathbf{g} &= \bzero && \text{on $\Lambda_s$} & \tikzmark{gstop} \\
\nabla \cdot \bu &= 0 && \text{''} \\
\bu &= \bzero && \text{on $\Gamma_0$ \quad (ice base)} \\
\left(2 \nu_\eps D\bu - pI\right) \bn &= \bzero && \text{on $\partial \Lambda_s \setminus \Gamma_0$} & \tikzmark{gsbot}
\end{align*}

\begin{tikzpicture}[overlay, remember picture]
\draw[decoration={brace,amplitude=0.4em},decorate,ultra thick] ([xshift=-7mm]ncptop.north east) node[right=8mm,below=3mm] {NCP} -- ([xshift=-7mm]ncpbot.east);
\end{tikzpicture}

\begin{tikzpicture}[overlay, remember picture]
\draw[decoration={brace,amplitude=0.4em},decorate,ultra thick] ([xshift=-7mm]gstop.north east) node[right=10mm,below=6mm] {Stokes} -- ([xshift=-7mm]gsbot.east);
\end{tikzpicture}

\vspace{-8mm}

    \begin{itemize}
    \item Glen-law effective viscosity with $\text{p}=(1/\text{n})+1(=4/3)$:
      $$\nu_\eps = \frac{1}{2} B_n \left(|D\bu|^2 + \eps\, D_0^2\right)^{(\pp-2)/2}$$
    \item \emph{count the 3 nonlinearities}
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{\alert{implicit} IGP strong form}

\begin{itemize}
\item solve one step of backward Euler for $s,\bu,p$ at new time $t^\ell$
    \begin{itemize}
    \item $\frac{\partial s}{\partial t} \approx \frac{s^\ell-s^{\ell-1}}{\Delta t}$ in evolving SKE, and write $s$ for $s^\ell$
    \end{itemize}
\item again get an NCP coupled to a Stokes problem:

\vspace{-5mm}

\begin{align*}
s - b &\ge 0 && \text{on $\Omega$} \\
\alert{s - s^{\ell-1} - \Delta t\, \bu|_s \cdot \bn_s - \Delta t\, a} &\ge 0 && \text{''} \\
(s - b) (\alert{s - s^{\ell-1} - \Delta t\, \bu|_s \cdot \bn_s - \Delta t\, a}) &= 0 && \text{''} \\
- \nabla \cdot \left(2 \nu_\eps\, D\bu\right) + \nabla p - \rhoi \mathbf{g} &= \bzero && \text{on $\Lambda_s$} \\
\nabla \cdot \bu &= 0 && \text{''} \\
\bu &= \bzero && \text{on $\Gamma_0$} \\
\left(2 \nu_\eps D\bu - pI\right) \bn &= \bzero && \text{on $\partial \Lambda_s \setminus \Gamma_0$}
\end{align*}

    \begin{itemize}
    \item \alert{similar \dots mostly suffices to consider steady IGP}
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{existing ice sheet models}

\begin{itemize}
\item almost no one is solving the implicit IGP
    \begin{itemize}
    \item except Brinkerhoff et al (2017) (\emph{upwinding, semi-coupled})
    \item and Wirbel \& Jarosch (2020) (\emph{semi-coupled, artificial ice layer})
    \item neither scalable (\emph{single level}) nor unconditionally stable
    \end{itemize}
\item what are people doing instead?
    \begin{itemize}
    \item \alert{explicit time-stepping with $s \ge b$ enforced by truncation}
    \item often with shallow approximations, e.g.~PISM run below

\medskip
\begin{columns}
    \column{0.7\textwidth}
        \includegraphics[width=0.8\textwidth]{figs/seguinot.png}
    \column{0.3\textwidth}
        \scriptsize \emph{by Julien Seguinot}
\end{columns}

\medskip
    \item \emph{my goal}: unconditionally-stable implicit with Stokes dynamics
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{coupling via operator}

\begin{block}{ice dynamics operator}
$\Phi : s \mapsto - \bus \cdot \bn_s$

\vspace{-3mm}

\hfill \includegraphics[width=0.7\textwidth]{figs/idoaction.png}
\end{block}

\begin{itemize}
\item to compute $\Phi(s)$: build $\Lambda_s$, solve weak-form Stokes problem
    $$F_{\Lambda_s}(\bu,p)[\bv,q] = \int_{\Lambda_s} 2 \nu_\eps D\bu : D\bv - p \Div\bv - (\Div\bu) q - \rhoi \bg \cdot \bv\,d\bx = 0,$$
extract trace $\bus$, then extend $\Phi(s) = -\bus \cdot \bn_s$ by zero to $\Omega$
\item regarding Stokes problem for fixed geometry:
    \begin{itemize}
    \item well-posed over $W_0^{1,\pp}(\Lambda_s)^3 \times L^\qq(\Lambda_s)$ (Jouvet \& Rappaz 2011)
    \item optimal solver exists (Isaac et al 2015)
    \end{itemize}
\item $\therefore$ \, $\phi(s)$ is well-defined if $s$ is piecewise $C^1$
    \begin{itemize}
    \item a regularity conjecture
    \end{itemize}
\end{itemize}

\end{frame}


\begin{frame}{IGP weak form is a variational inequality}

\begin{itemize}
\item using $\Phi$ gives a cleaner NCP over $\Omega$ for steady IGP:
\begin{align*}
s - b &\ge 0 \\
\Phi(s) - a &\ge 0 \\
(s - b) (\Phi(s) - a) &= 0
\end{align*}

\item NCP (strong form) $\leftrightarrow$ VI (weak form)

\begin{block}{steady IGP weak form}
find admissible $s \in \mathcal{K} = \{r \ge b\} \subset W^{1,\qq}(\Omega)$ so that
    $$\ip{\Phi(s)-a}{r-s} \ge 0$$
for all $r \in \mathcal{K}$
\end{block}

\item well-posedness is completely open
    \begin{itemize}
    \item but existence holds for SIA version (Jouvet \& Bueler, 2012)
    \end{itemize}

\end{itemize}
\end{frame}


\begin{frame}{what kind of beast is $\Phi$?}

\begin{center}
\includegraphics[width=0.7\textwidth]{figs/idoaction.png} \hfill \includegraphics[width=0.15\textwidth]{figs/elephant.png}
\end{center}

\begin{itemize}
\small
\item $\Phi : \mathcal{K} \subset W^{1,\qq}(\Omega) \to W^{-1,\pp}(\Omega)$ where $\qq=4$ and $\pp=4/3$
\item the Stokes stress balance is nonlocal so $\Phi$ is ``dense''
    \begin{itemize}
    \item $\Phi$ is some kind of integral operator? (\emph{convolve with Stokeslets})
    \item $\Phi$ is short range? (\emph{concentrated near the diagonal})
    \end{itemize}
\item $\Phi \approx \Phi_{\text{SIA}}$ for shallow glaciers, a differential operator:
    $$\Phi_{\text{SIA}}(s) = - \frac{\gamma}{\qq} (s-b)^{\qq} |\grad_2 s|^{\qq} - \grad_2 \cdot\left[\frac{\gamma}{\qq+1} (s-b)^{\qq+1} |\grad_2 s|^{\qq-2} \grad_2 s\right]$$

    \begin{itemize}
    \item $\Phi$ is diffusive in the large!
    \item $\Phi$ is degenerate at the ice margin!
    \end{itemize}
\item yet common to say $\Phi$ is hyperbolic because SKE is transport equation for thickness: $H_t + \overline{\bu}\, \grad H = a$
\end{itemize}
\end{frame}


\begin{frame}{goal: robust and optimal IGP solver}

\begin{block}{numerical goal}
given triangulation $\mathcal{T}$ of $\Omega$ and $P_1$ space $\mathcal{V}^h \subset W^{1,\qq}(\Omega)$, and convex set $\mathcal{K}^h = \{r^h \ge b^h\} \subset \mathcal{V}^h$, solve VI for $s^h \in \mathcal{K}^h$:

$$\ip{\Phi^h(s^h) - a}{r^h - s^h} \ge 0 \qquad \text{for all $r^h \in \mathcal{K}^h$}$$
\end{block}

\begin{itemize}
\item[]
    \begin{itemize}
    \item $P_1$ because low regularity at free boundary
    \item uses numerical solution of Stokes problem $F_{\Lambda_{s^h}}(\bu^h,p^h)=0$ to evaluate $\Phi^h(s^h)=-\bu|_{s^h}\cdot\bn_{s^h}$
    \end{itemize}
\item seeking a solver which is:
    \begin{itemize}
    \item \alert{robust}
    \item \alert{optimal} over $m$ degrees of freedom in $\mathcal{V}^h$ 
        \begin{itemize}
        \item[{\color{black} $\circ$}] optimal means work is $O(m)$ \dots requires multigrid
        \end{itemize}
    \item<2> \emph{for now these are aspirations \dots}
    \end{itemize}
\end{itemize}
\end{frame}



\begin{frame}{Stokes on an extruded mesh}

\begin{itemize}
\item FIXME
\end{itemize}

\includegraphics[width=0.8\textwidth]{figs/extruded.png}
\end{frame}


\begin{frame}{multilevel constraint decomposition}

\begin{itemize}
\item FIXME
\end{itemize}

\includegraphics[width=0.5\textwidth]{figs/decompclassical.png}

\input{tikz/vcycle.tex}
\end{frame}



\begin{frame}{smoothers}

\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}


%\begin{block}{Block}
%\begin{alertblock}{Alert block}
%	\pause % Automatically creates a new "page" split between the above and above + below
%	\begin{exampleblock}{Example block}


%\begin{frame}{Columns}
%	\begin{columns}
%		\column{0.5\textwidth}
%			This text
%		\column{0.5\textwidth}
%			\includegraphics[width=\linewidth]{figs/extruded.png}
%	\end{columns}
%\end{frame}


\appendix

\begin{frame}{Some references}
%\bibliography{../paper/msg.bib}
%\bibliographystyle{plain}

\begin{thebibliography}{1}
\bibitem{BuelerMitchell2022}
E.~Bueler and L.~Mitchell. \textbf{Multilevel computation of glacier geometry from Stokes dynamics.} in preparation

\hrulefill

\bibitem{Brinkerhoffetal2017}
D.~Brinkerhoff, M.~Truffer, and A.~Aschwanden. \textbf{Sediment transport drives tidewater glacier periodicity.} {\em Nature Communications}, 8(1):1--8, 2017.

\bibitem{IsaacStadlerGhattas2015}
T.~Isaac, G.~Stadler, and O.~Ghattas.  \textbf{Solution of nonlinear Stokes equations \dots with application to ice sheet dynamics.} {\em SIAM J. Sci. Comput.}, 37(6):B804--B833, 2015.

\bibitem{WirbelJarosch2020}
A.~Wirbel and A.~H. Jarosch. \textbf{Inequality-constrained free-surface evolution in a full {S}tokes ice flow model \dots} {\em Geosci. Model Dev.}, 13(12):6425--6445, 2020.
\end{thebibliography}
\end{frame}

\begin{frame}{extra}

NCP is a barrier to exact numerical mass conservation\footnote{E.~Bueler. \textbf{Conservation laws for free-boundary fluid layers.} \em{SIAM J.~Appl.~Math.}, to appear.}
\end{frame}
\end{document}
